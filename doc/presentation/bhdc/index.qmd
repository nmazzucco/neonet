---
title: "NeoNet app"
subtitle: "Radiocarbon modelling for the Late Mesolithic/Early Neolithic transition in South-Central and South-Western Europe"
author:
  - name: Thomas Huet
    affiliation: 
      - id: uo
        name: <span style="font-size:16pt">University of Oxford</span>
  - name: Niccolò Mazzucco
    affiliation: <span style="font-size:16pt">Università di Pisa</span>
  - name: Miriam Cubas Morera
    affiliation: <span style="font-size:16pt">Universidad de Alcalá</span>
  - name: Juan F. Gibaja
    affiliation: 
      - id: csic
        name: <span style="font-size:16pt">Consejo Superior de Investigaciones Científicas</span>
  - name: F. Xavier Oms
    affiliation: <span style="font-size:16pt">Universitat de Barcelona</span>
  - name: António Faustino Carvalho
    affiliation: 
      - id: ua
        name: <span style="font-size:16pt">Universidade do Algarve</span>
  - name: Ana Catarina Basílio
    affiliation: 
      - ref: ua
  - name: Elías López-Romero
    affiliation:
      - ref: csic
title-slide-attributes:
    data-background-image: "img/chalkboard.png"
    data-background-size: "90%"
    data-background-opacity: "0.3"
format:
  revealjs: 
    css: https://zoometh.github.io/thomashuet/css/quarto.css
    auto-stretch: false
    code-fold: false
    code-summary: "<small>Code</small>"
    slide-number: true
    chalkboard:
      theme: "whiteboard"
      color: ['rgba(255, 0, 0, 0.3)'] # red
    scrollable: true
    preview-links: auto
    reference-location: document
    footnotes-hover: true
    # self-contained: true
    # embed-resources: true
    logo: https://raw.githubusercontent.com/zoometh/neonet/master/doc/img/neonet.png
    footer: "<em>Big Historical Data Conference</em> <img src='https://raw.githubusercontent.com/zoometh/neonet/master/doc/presentation/bhdc/img/bhdc_avatar.png' style='height: 35px;vertical-align: middle;'> <https://bhdc.earth/> 22-25 November 2023, Jena (Germany)"
    margin: 0
    width: 1200
---


## {data-background-iframe="http://shinyserver.cfs.unipi.it:3838/C14dev" background-interactive="true"}

::: {.notes}
NeoNet app is an opensource R Shiny interactive web app which facilitates the study of radiocarbon dates by providing selection tools for spatial information, chronology, and date accuracy. The map interface offers a mobile and multi-scalar window to study the dynamic of last hunter-gathers / early farmers frontiers <br>
NB: prepare the map: Global view / clustered / ortho ; Explode cluster / ungroup / OSM
:::

## {}

The NeoNet Atl dataset

```{r}
library(dplyr)
library(DT)
neonet_med <- "https://digitallib.unipi.it/fedora/objects/mag:2627/datastreams/MMb1a4a927461fdd822e923821b8d92371/content"
df.c14 <- read.csv2(neonet_med, sep = "\t", encoding = "UTF-8")
font.size <- "8pt"
df.c14[,!names(df.c14) %in% c("tpq", "taq")] %>% 
  DT::datatable(
    width = "100%",
    rownames = FALSE,
    options=list(
      lengthMenu = list(c(10, 50, -1), 
                        c('10', '50', 'All')),
      paging = T,
      initComplete = htmlwidgets::JS(
        "function(settings, json) {",
        paste0("$(this.api().table().container()).css({'font-size': '", font.size, "'});"),
        "}")
    ) 
  )
```


::: {.notes}
NeoNet is presently split into two datasets: NeoNet Med, dedicated to the Mediterranean, and NeoNet Atl, focusing on the Atlantic region. These datasets have been assembled by experts specializing in each of these geographic areas. Together, they encompass approximately 4,000 radiocarbon dates belonging to around 3,000 distinct archaeological layers and approximately 800 sites. These dates and archaeological contexts are supported by roughly 600 different bibliographical references.
:::


## {}

<div class="img">
![](img/neo_datasum_by_periods_samp.png){height="220"}
![](https://raw.githubusercontent.com/zoometh/neonet/master/doc/img/neonet_med_spd.png){height="250"}
</div>
<div class="captiontext">Spatial distribution of the two main periods (<span style="color:blue"><b>LM</b></span> and <span style="color:red"><b>EN</b></span>) with the SPD of the whole NeoNet Med dataset (same colors)
</div>

<div class="img"><center>
![](img/open-data-joad.png){width="600"}
</center></div>
<div class="captiontext">Publication of the corresponding data paper 
</div>

::: {.notes}
NeoNet Med, which encompasses the North Central-Western Mediterranean Basin, was the initial dataset to be made available to the public. Our data paper, published in the *Journal of Open Archaeological Data*, offers a comprehensive account of the data collection process, including steps, quality control, metadata, and other essential details. Additionally, it provides valuable insights into how the dataset can be effectively reused for various purposes.
:::

## {}

<div class="img">
![](img/watersheds-ortho.png){width="1100"}
</div>

::: {.notes}
NeoNet spatial coverage is depicted in red. It has been completed by the Southern European Atlantic Basin (in blue).
The decision to partition the research area into separate river basins is rooted in two main considerations:
1. Firstly, it permits the systematic breakdown, or hierachical decomposition, of river basins into interconnected and nested components.
2. Secondly, watersheds hold significant importance as spatial analysis units, enabling mathematical modeling that integrates key concepts such as catchment area, thalweg (shortest path), and natural boundaries.

:::

## {}

<div class="img">
![](img/watersheds-climate.png){width=1000px}
</div>
<div class="captiontext">Beck et al. 2018, Present and future Köppen-Geiger climate classification maps at 1-km resolution, Nature Scientific Data
</div>

::: {.notes}
As an example, the application incorporates the current Koppen climate classification as a base map. This feature enables users to filter the dataset by different climate regions and delve into how these climates might have played a role in shaping the Neolithic expansion.
:::


## {}

<div class="img">
![](img/donzere-gis.png){width="1000"}
</div>
<div class="captiontext">Beck et al. 2018, Present and future Köppen-Geiger climate classification maps at 1-km resolution, Nature Scientific Data
</div>

::: {.notes}
For example, the Défilé de Donzère is a narrow pass in the Rhone valley that runs from North to South, situated between the Alps in the east and the Massif Central in the west. This region experiences a Mediterranean climate in the south (`Csa` - Temperate, dry summer, hot summer) and a continental climate in the north (`Cfb` - Temperate, no dry season, warm summer).
:::

## {}

<div class="img">
![](img/donzere-view.png){width=1200px}
<div class="captiontext">View of the Défilé de Donzère and the Rhône river, from the South in Google Earth</div>


::: {.notes}
View of the Défilé de Donzère and the Rhône river, from the South
:::

## {}

<div class="img"><center>
![](img/donzere-app-north-and-south.png){width="900"}
</div>


::: {.notes}
You can create a selection window around the Défilé, specifically choosing dates from the Late Mesolithic (LM) and Early Neolithic (EN) periods, with a standard deviation (SD) of less than 130. Upon completing this process, the dataset will contain 70 sites and 353 dates. Moreover, these dates can be calibrated on the fly by selecting one of them and accessing the calib (calibration) panel.
:::

## {}

<div class="img"><center>
![](img/donzere-app-north-and-south-calib-1.png){width="900"}
</div>

::: {.notes}
Dates can be aggregated and seriated by periods, sites and period, archaeological layer (PhaseCode), or plotted individually. Here by periods
:::



## {}

<div class="img"><center>
![](img/donzere-app-north-and-south-calib.png){width="900"}
</center></div>

::: {.notes}
Here by sites and period. Graphics can be exported using a download button
Export the plot
:::


## {}


<div class="img"><center>
![](img/donzere-app-north-and-south.png){width="900"}
</center></div>


::: {.notes}
The selected area and the selected dates can also be exported, both in GeoJSON files, using two other export buttons on the top left of the map panel
:::

## {}

```{r}
library(sf) ; library(dplyr) ; library(leaflet)
dirIn <- "https://raw.githubusercontent.com/zoometh/neonet/main/doc/presentation/bhdc/data/"
```

:::: {.columns}

::: {.column width="50%"}

<span class= smalltext>`neonet-data-2023-10-22-select-aera.geojson`</span>

```{r}
df <- st_read(paste0(dirIn, "neonet-data-2023-10-22-select-aera.geojson"), quiet = T)
leaflet(df, width = "500px") %>%
  addTiles() %>% 
  addPolygons()       # Change weight as needed
```

:::

::: {.column width="50%"}

<span class= smalltext>`neonet-data-2023-10-22.geojson`</span>

```{r}
df <- st_read(paste0(dirIn, "neonet-data-2023-10-22.geojson"),  quiet = T)
leaflet(df, width = "500px") %>%
  addTiles() %>% 
  addCircleMarkers()       # Change weight as needed
```

:::

::::


::: {.notes}
These files can undergo a secondary curation and subsetting process in a GIS or any other appropriate application <br>
Date that have been removed: 
- Grotte de Camprafaud, lyer 20,Gif-3077
- Abri de la Font-des-Pigeons, Escalon C5-F5-C6F6, KN-182
- Petites Baties, sect. 4, Beta-103872
- Mas Neuf, Erl-11802
- Pontcharaud 2, c.3, Ly-7625
- Clos de Poujol, c. Sn-Sn1, Ly-2138 (OxA)
:::

## {}

<img src='https://raw.githubusercontent.com/zoometh/thomashuet/master/img/app-github.png' style='height: 40px;vertical-align: middle;'><img src='https://raw.githubusercontent.com/zoometh/neonet/master/doc/img/logo_nn_pkg.png' style='height: 50px;vertical-align: middle;'> <span class= smalltext><https://github.com/zoometh/neonet> </span>

:::: {.columns}

::: {.column width="30%"}

![](img/github-neonet-functions-1.png){width="700" style='horizontal-align: middle;'}

:::

::: {.column width="70%"}

```{.r}
neo_datasum(df.c14, 
            info = c("maps"),
            roi = "https://github.com/zoometh/neonet/blob/main/doc/data/wsh_atl.geojson")
```

<div class="img"><center>
![](https://raw.githubusercontent.com/zoometh/neonet/main/results/atl_test.png){width="700" style='horizontal-align: middle;'}
</center></div>


```{.r}
neo_spd(df.c14 = df.c14)
```

<div class="img"><center>
![](img/figure2.png){width="700" style='horizontal-align: middle;'}
</center></div>

```{.r}
neo_isochr(df.c14 = "neonet-data-2023-10-22.geojson")
```

<div class="img"><center>
![](img/donzere_EN-neolithic-isochr.png){width="450" style='horizontal-align: middle;'}
</center></div>

```{.r}
neo_isochr(df.c14 = "neonet-data-2023-10-22.geojson", 
           selected.per = "LM")
```

<div class="img"><center>
![](img/donzere_LM-paleolithic-isochr.png){width="450" style='horizontal-align: middle;'}
</center></div>

```{.r}
neo_strat(inData = "Roc du Dourgne_2023-07-30.csv")
```

<div class="img"><center>
![](https://raw.githubusercontent.com/zoometh/neonet/main/doc/img/app-strati-diag-dourgne-period.png){width="450" style='horizontal-align: middle;'}
</center></div>


:::

::::

::: {.notes}
The Shiny app also comes with documentation and others functions to calculate SPDs, isochrones and Harrix matrices among other things.
:::

## {}

<img src='https://raw.githubusercontent.com/zoometh/thomashuet/master/img/app-github.png' style='height: 40px;vertical-align: middle;'><img src='https://raw.githubusercontent.com/zoometh/neonet/master/doc/presentation/bhdc/img/c14bazaar-logo.png' style='height: 50px;vertical-align: middle;'> <span class= smalltext><https://github.com/ropensci/c14bazAAR></span>

:::: {.columns}

::: {.column width="30%"}

![](img/github-c14bazaar-functions-1.png){width="700" style='horizontal-align: middle;'}

:::

::: {.column width="70%"}

![](img/github-c14bazAAR-dbs.png){width="700" style='horizontal-align: middle;'}

:::

::::



::: {.notes}
In conclusion, we acknowledge that NeoNet is just one of the numerous radiocarbon datasets as radiocarbon modeling is a well-explored field. This is precisely why we have developed a *getter* function within the C14bazaar package for the dataset's to be harvestable, and we remain committed to enhancing data and data sample re-usability.
:::


## Conclusion

* App and dataset of 14C dates for the **Mesolithic / Neolithic transition**
* Open Data, Open Source, Open Access ➡️ **Open Science**
* Scalable, incrementable, reusable, analyzable ➡️ **Reproducibility**

**Perspectives**

* Extension of the dataset to other river basins
* Build sites' Harris matrices and run Bayesian analysis on-the-fly

::: {.notes}
* Neonet offers an App and curated dataset of radiocarbon dates for the Mesolithic / Neolithic transition
* The dataset is OD, the app and management functions are OSrc and OA. Compliant with OSci
* Watersheds partition is highly modular (hierarchical decomposition) and interactivity offer a great mean for reproductibility and robust assumptions.
:::

## Credits


* <span class= smalltext>"Tools, Techniques and Specialists: the keys to understand the Mesolithic-Neolithic transition in Mediterranean Europe" (PID2020-112513RB-I00) financiado/a por MCIN/AEI/ 10.13039/501100011033 </span>

* <span class= smalltext>"Origen, desarrollo y consolidación del neolítico en el ámbito Mediterráneo (RED2018-102382-T)" Redes de Investigación, 2020-2021</span>

* <span class= smalltext>Conexiones en el Sur de la Península durante el Neolítico (RED2022-134436-T)</span>

![](https://raw.githubusercontent.com/zoometh/neonet/master/doc/img/inst-gobierno-de-espana.png){height="80"}
![](https://raw.githubusercontent.com/zoometh/neonet/master/doc/img/inst-agencia-investigacion.png){height="80"}

![](https://raw.githubusercontent.com/zoometh/neonet/master/doc/img/inst-csic.png){height="80"}
</p>



